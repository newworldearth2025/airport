import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# æ•µæ©Ÿã®åˆæœŸä½ç½®ãƒ»é€Ÿåº¦ï¼ˆç›´é€²ï¼‰
enemy_pos = np.array([1000.0, 1000.0, 1000.0])
enemy_vel = np.array([-20.0, -5.0, 0.0])  # é…ã‚ã«

# è‡ªæ©Ÿã®åˆæœŸä½ç½®ï¼ˆå›ºå®šï¼‰
fighter_pos = np.array([0.0, 0.0, 0.0])

# ãƒŸã‚µã‚¤ãƒ«ã®åˆæœŸä½ç½®ãƒ»é€Ÿåº¦
missile_pos = fighter_pos.copy()
missile_speed = 100.0  # m/s

# æ™‚é–“è¨­å®š
dt = 0.1
T = 30  # ç§’
steps = int(T / dt)

# è¨˜éŒ²ç”¨
missile_traj = []
enemy_traj = []

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
for step in range(steps):
    # æ•µæ©Ÿã®ç§»å‹•
    enemy_pos += enemy_vel * dt
    enemy_traj.append(enemy_pos.copy())

    # ãƒŸã‚µã‚¤ãƒ«ã®è¿½å°¾æ–¹å‘ï¼ˆãƒ™ã‚¯ãƒˆãƒ«æ­£è¦åŒ–ï¼‰
    direction = enemy_pos - missile_pos
    distance = np.linalg.norm(direction)

    if distance < 10:  # å‘½ä¸­åˆ¤å®š
        print(f"ğŸ’¥ Hit at t = {step * dt:.2f} seconds!")
        break

    direction_normalized = direction / distance

    # ãƒŸã‚µã‚¤ãƒ«ã®ç§»å‹•
    missile_pos += direction_normalized * missile_speed * dt
    missile_traj.append(missile_pos.copy())

# é…åˆ—åŒ–
missile_traj = np.array(missile_traj)
enemy_traj = np.array(enemy_traj)

# 3Dãƒ—ãƒ­ãƒƒãƒˆ
fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection='3d')
ax.plot(*missile_traj.T, label='Missile Path', color='red')
ax.plot(*enemy_traj.T, label='Enemy Path', color='blue')
ax.scatter(*fighter_pos, color='green', s=100, label='Fighter')
ax.set_xlabel("X")
ax.set_ylabel("Y")
ax.set_zlabel("Z")
ax.set_title("Missile Tracking Enemy Aircraft")
ax.legend()
plt.tight_layout()
plt.show()
